**SW 개발 문서**

Research Relationship Visualization Service

  ---------------------- ------------------------------------------------
  문서 버전              1.0

  작성일                 2025년 2월

  프로젝트명             Multi-Actor Research Relationship Visualization
                         Service

  시스템 유형            MVP (Minimum Viable Product)
  ---------------------- ------------------------------------------------

목차

1\. 프로젝트 개요

1.1 목적

학술 연구 데이터(OpenAlex, CSV)를 수집·분석하여 연구자 간 협업 관계,
키워드 공기 패턴, 기관 협력 네트워크, 국가 간 공동연구 현황을 인터랙티브
네트워크 그래프와 히트맵으로 시각화하는 서비스입니다.

1.2 핵심 기능

-   Multi-Actor 데이터베이스: 연구 그룹/프로젝트별 독립 DB 운영

-   OpenAlex API 연동: 2.5억+ 학술 데이터 접근 및 자동 메타데이터 추출

-   4계층 네트워크 시각화: 저자(Co-authorship), 키워드(Co-occurrence),
    기관, 국가

-   히트맵 분석: 저자-키워드 매트릭스, 국가 간 협력 강도

-   저자 디스앨비귀이션 강화: H-index, i10-index, ORCID, 연구분야 정보
    표시

-   Focus Mode: 특정 노드 중심 네트워크 탐색 (Full Network / Focus Only)

-   CSV 가져오기/내보내기 및 저자 병합(Merge) 기능

1.3 대상 사용자

-   학술 기관 연구자 및 연구 관리자

-   기업 R&D 부서

-   학술 출판사 및 데이터 분석가

2\. 시스템 아키텍처

2.1 전체 구성도

본 시스템은 Frontend(Streamlit) -- Backend(FastAPI) -- Database(SQLite)
3계층 구조로 설계되었으며, 외부 데이터 소스로 OpenAlex API를 연동합니다.

  -----------------------------------------------------------------------
  **계층**        **기술 스택**      **역할**
  --------------- ------------------ ------------------------------------
  Frontend        Streamlit          웹 UI, 사용자 인터랙션, 시각화
                                     렌더링

  Backend         FastAPI (Python)   REST API, 비즈니스 로직, 데이터 처리

  Database        SQLite +           Multi-Actor DB 관리, ORM 기반 데이터
                  SQLAlchemy         접근

  외부 API        OpenAlex REST API  학술 저작물·저자 메타데이터 조회

  시각화          PyVis, Plotly,     네트워크 그래프 및 히트맵 생성
                  NetworkX           
  -----------------------------------------------------------------------

2.2 디렉토리 구조

  ---------------------------------------------------------------------------------
  **파일/디렉토리**                    **설명**
  ------------------------------------ --------------------------------------------
  app/backend/main.py                  FastAPI 애플리케이션 진입점, API 라우트 정의

  app/backend/models.py                SQLAlchemy ORM 모델 정의 (12개 테이블)

  app/backend/schemas.py               Pydantic 요청/응답 스키마

  app/backend/crud.py                  CRUD 연산 및 엣지 재계산 로직

  app/backend/db.py                    Multi-Actor DB 세션 관리, 액터별 DB 파일
                                       관리

  app/backend/connectors_openalex.py   OpenAlex API 클라이언트 (저자 검색, 저작물
                                       조회)

  app/backend/service_graph.py         4계층 네트워크 그래프 빌드 로직

  app/backend/services_heatmap.py      히트맵 데이터 생성 서비스

  app/backend/services_export.py       CSV/ZIP 내보내기 서비스

  app/frontend/streamlit_app.py        Streamlit 프론트엔드 전체 UI

  databases/                           액터별 SQLite DB 파일 저장 디렉토리
  ---------------------------------------------------------------------------------

3\. 데이터베이스 설계

3.1 ERD 개요

SQLAlchemy ORM 기반으로 12개 테이블을 정의하며, Multi-Actor 시스템으로
액터마다 별도의 SQLite 파일을 생성합니다.

3.2 핵심 테이블 정의

**authors 테이블**

  ---------------------------------------------------------------------------
  **컬럼명**        **타입**      **제약조건**   **설명**
  ----------------- ------------- -------------- ----------------------------
  id                Integer       PK             자동증가 기본키

  normalized_name   String        INDEX          정규화된 저자명 (lowercase)

  display_name      String        INDEX          표시용 저자명

  orcid             String        NULLABLE       ORCID 식별자

  created_at        DateTime      DEFAULT NOW    생성 일시
  ---------------------------------------------------------------------------

**works 테이블**

  ----------------------------------------------------------------------------
  **컬럼명**      **타입**      **제약조건**      **설명**
  --------------- ------------- ----------------- ----------------------------
  id              Integer       PK                자동증가 기본키

  doi             String        UNIQUE, INDEX     논문 DOI

  source_uid      String        UNIQUE(+source)   OpenAlex ID 등 외부 식별자

  title           Text          NOT NULL          논문 제목

  abstract        Text          NULLABLE          초록

  year            Integer       INDEX             출판 연도

  venue_id        Integer       FK(venues)        발표 매체 참조

  url             String        NULLABLE          원문 URL

  type            String        NULLABLE          문헌 유형 (journal-article
                                                  등)

  language        String        NULLABLE          언어 코드

  source          String        DEFAULT OpenAlex  데이터 출처

  raw_json        JSON          NULLABLE          OpenAlex 원본 JSON
  ----------------------------------------------------------------------------

**관계 테이블 요약**

  ------------------------------------------------------------------------
  **테이블명**        **설명**
  ------------------- ----------------------------------------------------
  work_authors        논문-저자 M:N 관계 (position, corresponding 포함)

  work_affiliations   논문-저자-기관 소속 관계 (country_code 포함)

  work_keywords       논문-키워드 M:N 관계 (weight, extractor 포함)

  author_aliases      저자 별칭 관리 (disambiguation 용)

  coauthor_edges      공저자 관계 엣지 (사전 계산된 가중치)

  org_edges           기관 간 협력 엣지

  nation_edges        국가 간 협력 엣지

  merges              저자 병합 이력 로그
  ------------------------------------------------------------------------

4\. API 설계

4.1 액터 관리 API

  -----------------------------------------------------------------------------
  **메서드**   **엔드포인트**                **설명**
  ------------ ----------------------------- ----------------------------------
  GET          /actors                       전체 액터 목록 및 통계 조회

  POST         /actors/{actor_name}/init     새 액터 DB 초기화

  DELETE       /actors/{actor_name}          액터 DB 삭제

  GET          /actors/{actor_name}/stats    액터별 상세 통계

  GET          /actors/{actor_name}/export   액터 데이터 CSV/ZIP 내보내기
  -----------------------------------------------------------------------------

4.2 데이터 수집 API

  --------------------------------------------------------------------------
  **메서드**   **엔드포인트**             **설명**
  ------------ -------------------------- ----------------------------------
  GET          /search-authors?q={name}   OpenAlex 저자 검색 (디스앨비귀이션
                                          정보 포함)

  POST         /{actor}/ingest/openalex   OpenAlex에서 저자 저작물 수집

  POST         /{actor}/import/csv        CSV 파일에서 데이터 가져오기
  --------------------------------------------------------------------------

4.3 시각화 API

  -------------------------------------------------------------------------
  **메서드**   **엔드포인트**            **설명**
  ------------ ------------------------- ----------------------------------
  POST         /{actor}/graph            네트워크 그래프 생성 (4계층 지원)

  POST         /{actor}/heatmap          히트맵 데이터 생성
  -------------------------------------------------------------------------

4.4 검색/검증 API

  -----------------------------------------------------------------------------------
  **메서드**   **엔드포인트**                      **설명**
  ------------ ----------------------------------- ----------------------------------
  GET          /{actor}/search-local-authors?q=    로컬 DB 저자 검색

  GET          /{actor}/search-local-keywords?q=   로컬 DB 키워드 검색

  GET          /{actor}/search-local-orgs?q=       로컬 DB 기관 검색

  POST         /{actor}/validate-authors           저자 ID 유효성 검증

  POST         /{actor}/validate-keywords          키워드 ID 유효성 검증

  POST         /{actor}/validate-orgs              기관 ID 유효성 검증
  -----------------------------------------------------------------------------------

5\. 핵심 비즈니스 로직

5.1 데이터 수집 파이프라인

1.  OpenAlex API에서 저자 검색 (search_authors_by_name)

2.  저자 선택 후 저작물 목록 조회 (list_author_works)

3.  각 저작물을 upsert_work_from_openalex로 DB에 저장

4.  저자, 기관, 키워드 자동 추출 및 get_or_create 패턴 적용

5.  엣지 재계산: coauthor_edges, org_edges, nation_edges 일괄 갱신

5.2 그래프 빌드 로직 (build_graph)

4개 레이어(authors, keywords, orgs, nations) 각각에 대해 노드와 엣지를
생성하며, 연도 필터링, 엣지 가중치 필터링, Focus Mode(Full Network /
Focus Only) 기능을 지원합니다.

  -----------------------------------------------------------------------
  **모드**           **동작**
  ------------------ ----------------------------------------------------
  Full Network       전체 네트워크 표시, Focus 노드를 빨간색으로
                     하이라이트

  Focus Only         Focus 노드 + 직접 연결된 이웃 노드만 표시
  -----------------------------------------------------------------------

5.3 엣지 재계산 로직

데이터 수집/병합 시 전체 엣지를 삭제 후 재계산하는 방식을 사용합니다.

-   recompute_coauthor_edges: 각 논문의 저자 쌍(pair)별 공저 횟수 집계

-   recompute_org_edges: 각 논문의 기관 쌍별 협력 횟수 집계

-   recompute_nation_edges: 각 논문의 국가 쌍별 협력 횟수 집계

5.4 저자 병합 (merge_authors)

1.  removed_id의 WorkAuthor, WorkAffiliation을 kept_id로 재할당

2.  removed_id의 AuthorAlias를 kept_id로 이동

3.  removed_id 저자 레코드 삭제

4.  MergeLog에 병합 이력 기록

5.  전체 엣지 재계산 실행

6\. 프론트엔드 설계

6.1 UI 구성

  -----------------------------------------------------------------------
  **구성 요소**      **기능**
  ------------------ ----------------------------------------------------
  사이드바 - 액터    액터 생성/선택/삭제, 통계 표시, 내보내기
  관리               

  사이드바 - 데이터  OpenAlex 검색, 저자 카드 표시, CSV 업로드
  수집               

  How to Use 탭      빠른 시작 가이드, 핵심 개념, 시각화 설명, 트러블슈팅

  Overview 탭        액터 카드 대시보드, 시스템 전체 통계

  Graph 탭           4계층 네트워크 그래프, Focus Mode, ID 검색 도우미

  Heatmaps 탭        저자-키워드 / 국가-국가 히트맵
  -----------------------------------------------------------------------

6.2 시각화 엔진

  -----------------------------------------------------------------------
  **엔진**           **설명**
  ------------------ ----------------------------------------------------
  PyVis Network      물리 시뮬레이션 기반 인터랙티브 그래프,
                     드래그/줌/호버 지원

  Plotly Network     5가지 레이아웃 알고리즘(spring, circular,
                     kamada_kawai, spectral, shell)

  Plotly Heatmap     매트릭스 기반 색상 강도 시각화 (Viridis 컬러스케일)

  Fallback View      시각화 실패 시 테이블 기반 데이터 표시
  -----------------------------------------------------------------------

6.3 저자 디스앨비귀이션 UI

OpenAlex 검색 결과를 확장 정보 카드로 표시하여 동명이인 연구자 식별을
지원합니다.

-   발표 수, 인용 수, H-index, i10-index 메트릭

-   소속 기관 및 국가 정보

-   상위 3개 연구 분야 (신뢰도 점수 표시)

-   ORCID 식별자 (가용 시)

7\. 외부 연동

7.1 OpenAlex API 연동

  -------------------------------------------------------------------------------------------
  **항목**               **내용**
  ---------------------- --------------------------------------------------------------------
  Base URL               https://api.openalex.org

  저자 검색              GET /authors?search={name}&per_page=25

  저작물 조회            GET
                         /works?filter=author.id:{id}&per_page=200&sort=cited_by_count:desc

  응답 데이터            저자 프로필, 저작물 메타데이터, 기관정보, 키워드(concepts)

  페이징                 커서 기반 페이징, max_pages 설정으로 조회량 제한

  Timeout                저자 검색 30초, 저작물 조회 60초
  -------------------------------------------------------------------------------------------

8\. 배포 및 운영

8.1 시스템 요구사항

  ------------------------------------------------------------------------
  **항목**               **최소**                 **권장**
  ---------------------- ------------------------ ------------------------
  CPU                    2코어                    4코어 이상

  RAM                    4GB                      8GB 이상

  저장공간               5GB                      20GB 이상

  Python                 3.8+                     3.10+

  네트워크               인터넷 필수              브로드밴드 권장
  ------------------------------------------------------------------------

8.2 실행 방법

**Backend 실행**

uvicorn app.backend.main:app \--reload \--port 8000

**Frontend 실행**

streamlit run app/frontend/streamlit_app.py

8.3 환경 변수

  ------------------------------------------------------------------------
  **변수명**             **기본값**      **설명**
  ---------------------- --------------- ---------------------------------
  BACKEND_HOST           127.0.0.1       Backend 서버 호스트

  BACKEND_PORT           8000            Backend 서버 포트

  DATABASES_DIR          ./databases     SQLite DB 파일 저장 경로
  ------------------------------------------------------------------------

9\. 향후 계획

-   PDF 파싱을 통한 직접 논문 임포트

-   LLM 기반 키워드 추출 고도화

-   고급 중복 감지 알고리즘

-   그래프 내보내기 (GraphML, GEXF 포맷)

-   시계열 분석 및 네트워크 진화 추적

-   인용 네트워크 분석

-   협력 추천 시스템
